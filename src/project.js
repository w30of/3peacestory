require=function t(e,a,n){function i(o,r){if(!a[o]){if(!e[o]){var c="function"==typeof require&&require;if(!r&&c)return c(o,!0);if(s)return s(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var u=a[o]={exports:{}};e[o][0].call(u.exports,function(t){var a=e[o][1][t];return i(a||t)},u,u.exports,t,e,a,n)}return a[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({Button:[function(t,e,a){"use strict";cc._RF.push(e,"71b6dlIrqpJwYrLkDeH+dCl","Button"),cc.Class({extends:cc.Component,properties:{lbText:cc.Label},onLoad:function(){this.node.on("click",this.onTouch,this)},onTouch:function(){if(this.selectionData.effect&&gameCore.status.applyEffect(this.selectionData.effect),this.selectionData.moves&&!gameCore.getStatus().moves&&gameCore.status.setSelectionStop(this.selectionData),this.selectionData.drama){var t=this.selectionData.subSelections,e=null;t&&(e=function(){gameCore.selection.showSelections(t)}),gameCore.drama.pushDrama(this.selectionData.drama,e)}gameCore.selection.hideAll()},setSelectionData:function(t){this.selectionData=t,this.lbText.string=t.text}}),cc._RF.pop()},{}],DramaPlayer:[function(t,e,a){"use strict";cc._RF.push(e,"36c5bvfXFpLQLQQmXUCsxzB","DramaPlayer"),cc.Class({extends:cc.Component,properties:{lbDrama:cc.Label},start:function(){},pushDrama:function(t,e){cc.log("showing Drama:  "+t);var a=DramaConfig[t],n=this.textList;this.textList=this.textList||[];var i=getOrExec(a.textList);this.textList=this.textList.concat(i),e&&this.textList.push(e),this.dramaOver=!1,n&&this.next()},next:function(){if(!(this.dramaOver||this.textList.length<1)){var t=this.textList.shift();_.isFunction(t)?(t(),this.next()):_.isObject(t)?(gameCore.dramaEvent(t),this.next()):(this.fullText=t,this.isTyping=!0,this.charList=this.fullText.split(""),this.lbDrama.string="",this.updateFunc=this.updateText.bind(this),this.schedule(this.updateFunc,.03))}},showAll:function(){this.isTyping=!1,this.stopUpdate(),this.lbDrama.string=this.fullText,this.charList=[]},updateText:function(){this.isTyping=!0,this.charList.length>0?this.lbDrama.string+=this.charList.shift():(this.isTyping=!1,this.stopUpdate())},stopUpdate:function(){this.updateFunc&&(this.unschedule(this.updateFunc),this.updateFunc=null)},onTouch:function(){this.isTyping?this.showAll():this.next()}}),cc._RF.pop()},{}],GameCore:[function(t,e,a){"use strict";cc._RF.push(e,"a6907sQgQVOupbfnMOrqfkb","GameCore"),cc.Class({extends:cc.Component,properties:{dramaNode:cc.Node,statusNode:cc.Node,selectionNode:cc.Node},start:function(){window.gameCore=this,this.drama=this.dramaNode.getComponent("DramaPlayer"),this.drama.pushDrama("intro",null),this.drama.next(),this.status=this.statusNode.getComponent("Status"),this.status.resetPlayerStatus(),this.statusNode.active=!1,this.selection=this.selectionNode.getComponent("Selection")},dramaEvent:function(t){t.effect&&this.status.applyEffect(t.effect),t.type==DramaType.ShowStatus?this.statusNode.active=!0:t.type==DramaType.ShowSelection?this.showCurrentSelections():t.type==DramaType.ShowSelectionStop?this.status.showSelectionStop():(t.type,DramaType.BackToTitle)},showCurrentSelections:function(){var t=this.status.getEnding();t&&this.status.isPhase(PhaseType.Morning)?(this.statusNode.active=!1,this.drama.pushDrama(t.drama),this.drama.next()):this.selection.showSelections(phase2Selection(this.getStatus().phase))},getStatus:function(){return cloneObj(this.status.playerStatus)}}),cc._RF.pop()},{}],SelectionConfig:[function(t,e,a){"use strict";cc._RF.push(e,"593eaXJNDZC7pNdsb/1Axdq","SelectionConfig"),window.SelectionConfig={morning:{drama:"morning",subSelections:["work","netBar","walkAround"]},afternoon:{drama:"afternoon",subSelections:["netBar","walkAround"]},night:{drama:"night",subSelections:["bed15","room25","hotel80","sleepAtNetBar","sleepAtHaiXin"]},work:{text:"海信人力",drama:"workDrama",condition:function(){var t=gameCore.getStatus();return t.happy>20&&t.happy<80&&t.endurance<40&&t.health>20},subSelections:["oneDay","threeDay"]},oneDay:{text:"日结",drama:"oneDayWork"},threeDay:{text:"3天包吃住",drama:"threeDayWork",condition:function(){return gameCore.getStatus().health>20}},netBar:{text:"网吧",drama:"toNetBar",finishDrama:"netBarTimeUp",condition:function(){return gameCore.getStatus().money>6},subSelections:["bigWater","cheaterNoodle","gamble","playGame","stopPlay"],moves:4,effect:{money:-6}},bigWater:{text:"大水",drama:"bigWater",condition:function(){return gameCore.getStatus().money>2},effect:{money:-2}},cheaterNoodle:{text:"叫小吃",drama:"cheaterNoodle",condition:function(){return gameCore.getStatus().money>4},effect:{money:-4}},retDoubleHappy:{text:"红双喜散烟",drama:"retDoubleHappy",condition:function(){return gameCore.getStatus().money>.5},effect:{money:-.5}},playGame:{text:"玩游戏",drama:"playGame"},gamble:{text:"10块网赌",drama:"gamble",condition:function(){return gameCore.getStatus().money>50},subSelections:["gambleBig","gambleSmall"],effect:{money:-10}},gambleBig:{text:"买大",drama:"gambleFinish"},gambleSmall:{text:"买小",drama:"gambleFinish"},stopPlay:{text:"下机",drama:"stopPlay"},walkAround:{text:"闲逛",drama:"walkAround"},bed15:function(){var t={};return t.text="15块床位",t.effect={money:-15},t.condition=function(){return gameCore.getStatus().money>15},randomInt()>50?t.drama="bed15":randomInt()>20?t.drama="bed15happy":t.drama="bed15bad",t},room25:{text:"25包间",drama:"room25",effect:{money:-25},condition:function(){return gameCore.getStatus().money>25}},hotel80:function(){var t={};return t.text="80包间",t.effect={money:-80},randomInt()>80?t.drama="hotel80":t.drama="hotel80cold",t.condition=function(){return gameCore.getStatus().money>80},t},sleepAtNetBar:{text:"8元包夜",drama:"sleepAtNetBar",effect:{money:-8},condition:function(){return gameCore.getStatus().money>8}},sleepAtHaiXin:{text:"海信门口",drama:"sleepAtHaiXin",condition:function(){return gameCore.getStatus().money<15}}},cc._RF.pop()},{}],Selection:[function(t,e,a){"use strict";cc._RF.push(e,"470c4lfya1L1KFuqfzJLU9N","Selection"),cc.Class({extends:cc.Component,properties:{buttonPrefab:cc.Prefab},showSelections:function(t,e){this.clearAll(),this.dramaName=t.drama,this.selectionArr=cloneObj(t),_.isArray(this.selectionArr)||(this.selectionArr=this.selectionArr.subSelections),e?this.showButtons():this.showDrama()},showDrama:function(){DramaConfig[this.dramaName]?gameCore.drama.pushDrama(this.dramaName,this.showButtons.bind(this)):this.showButtons()},showButtons:function(){for(var t=this.selectionArr.length,e=0,a=0;a<t;++a){var n=getOrExec(SelectionConfig[this.selectionArr[a]]);n.condition?n.condition()&&(this.createButton(e,n),++e):(this.createButton(e,n),++e)}},createButton:function(t,e){var a=cc.instantiate(this.buttonPrefab),n=a.getComponent("Button");this.buttons.push(n),n.setSelectionData(e),this.node.addChild(a),a.setPositionY(-85*t)},hideAll:function(){this.clearAll()},clearAll:function(){if(this.buttons)for(var t in this.buttons)this.buttons[t].node.removeFromParent();this.buttons=[]}}),cc._RF.pop()},{}],Status:[function(t,e,a){"use strict";cc._RF.push(e,"69314tvJ/JO5Ld3aTO6Q5VL","Status"),cc.Class({extends:cc.Component,properties:{lbHealth:cc.Label,lbHappy:cc.Label,lbEndurance:cc.Label,lbMoney:cc.Label,lbChange:cc.Label,lbTime:cc.Label,nodeEffectPos:cc.Node,pfEffectLabel:cc.Prefab},applyEffect:function(t){t=getOrExec(t);for(var e in t){var a=t[e];"phase"==e.toLowerCase()?this.playerStatus.phase=a:"nextphase"==e.toLowerCase()&&!0===a?this.playerStatus.phase=getNextPhase(this.playerStatus.phase):this.playerStatus[e]+=a,this.playerStatus[e]=this.limitPlayerStatus(e,this.playerStatus[e]),this.showEffect(e,a)}this.redrawStatus()},setSelectionStop:function(t){this.playerStatus.moves=t.moves,this.selectionStop=t},showSelectionStop:function(){this.selectionStop&&(--this.playerStatus.moves<=0?(this.playerStatus.moves=null,gameCore.drama.pushDrama(this.selectionStop.finishDrama)):gameCore.selection.showSelections(this.selectionStop,!0))},isPhase:function(t){return this.playerStatus.phase==t},isChanged:function(){return this.playerStatus.change>=maxPlayerStatus.change},isDead:function(){return this.playerStatus.health<1||this.playerStatus.health<20&&this.playerStatus.endurance>80},getEnding:function(){return this.isDead()?this.getEndingFromList(endings.deadEnding):this.isChanged()?this.getEndingFromList(endings.changedEnding):null},getEndingFromList:function(t){var e=[];for(var a in t)t[a].condition()&&e.push(t[a]);return e=randomChoice(e)},redrawStatus:function(){this.lbHealth.string="健康："+this.playerStatus.health,this.lbHappy.string="快乐："+this.playerStatus.happy,this.lbEndurance.string="疲劳："+this.playerStatus.endurance,this.lbMoney.string="金钱："+this.playerStatus.money,this.lbChange.string=(this.playerStatus.change<5?"???：":"改变：")+this.playerStatus.change,this.lbTime.string=phase2Str(this.playerStatus.phase)},resetPlayerStatus:function(){this.playerStatus={};for(var t in defaultPlayerStatus)this.playerStatus[t]=defaultPlayerStatus[t];this.redrawStatus()},limitPlayerStatus:function(t,e){return maxPlayerStatus[t]&&(e=Math.max(0,e),e=Math.min(maxPlayerStatus[t],e)),e},showEffect:function(t,e){var a=this.getEffectY(t);if(null!=a){var n=cc.instantiate(this.pfEffectLabel);n.setPositionY(a),this.nodeEffectPos.addChild(n);var i=n.getComponent("effectLabelNode"),s=e>0?"+":"";i.setText(s+e),"endurance"==t?e>0?i.aniSub():i.aniAdd():e>0?i.aniAdd():i.aniSub()}},getEffectY:function(t){return"health"==t?this.lbHealth.node.getPositionY():"happy"==t?this.lbHappy.node.getPositionY():"endurance"==t?this.lbEndurance.node.getPositionY():"money"==t?this.lbMoney.node.getPositionY():"change"==t?this.lbChange.node.getPositionY():null}}),cc._RF.pop()},{}],effectLabelNode:[function(t,e,a){"use strict";cc._RF.push(e,"b322fWWEQNG1oZnOGfBkUXE","effectLabelNode"),cc.Class({extends:cc.Component,properties:{lbText:cc.Label},onLoad:function(){this.animMgr=this.getComponent(cc.Animation),this.animMgr.on("finished",this.animFinish,this)},animFinish:function(){this.node.removeFromParent()},setText:function(t){this.lbText.string=t},aniAdd:function(){this.animMgr.play("add")},aniSub:function(){this.animMgr.play("sub")}}),cc._RF.pop()},{}]},{},["Button","DramaPlayer","GameCore","Selection","SelectionConfig","Status","effectLabelNode"]);